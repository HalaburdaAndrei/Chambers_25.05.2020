@isTest
public with sharing class PersonSalesTargetWithPublControllerTest {

    @testSetup
    static void setup() {
        Profile p = [SELECT Id FROM Profile WHERE Name='Sales Management'];
        User u = new User(Alias = 'standt', Email='standarduser@testorg.com',
                EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US',
                LocaleSidKey='en_US', ProfileId = p.Id,
                TimeZoneSidKey='America/Los_Angeles', UserName='standardus@testorg.com');
        insert u;

        Publication__c pub1 = new Publication__c(
                Name = 'testPublicationAsia',
                Publication_Type__c = 'Asia',
                CC_Publication_ID_RE__c = '1234',
                Year_Issue_RE__c = '2019'
        );
        insert  pub1;

        Publication__c pub2 = new Publication__c(
                Name = 'testPublicationGuiede',
                Publication_Type__c = 'UK Guide',
                CC_Publication_ID_RE__c = '12234',
                Year_Issue_RE__c = '2020'
        );
        insert  pub2;

        Sales_Target__c salesTarget1 = new Sales_Target__c(Sales_Person__c = u.Id,
        Publication__c = pub2.Id,
        Date__c = Date.newInstance(Date.today().year(), Date.today().month(),1),
        Publication_Visible__c = true,
        Directory_Target__c = 10000,
        Insights_Target__c = 15000);
        insert salesTarget1;
    }

    @IsTest
    static void generateDatesTest (){
        Integer year = 2020;
        PersonSalesTargetWithPublController.generateDates(year);
        System.assertEquals(12, PersonSalesTargetWithPublController.generateDates(year).size());

    }

    @IsTest
    static void generateDataTableTest (){
        Integer year = 2020;
        PersonSalesTargetWithPublController.generateDataTable(year);
        System.assertEquals(1, [SELECT Id FROM Sales_Target__c].size());

    }

    @IsTest
    static void addPublicationListTest (){
        String jsonOld = '[{"expanded":false,"publications":[{"publicationId":"a021t00000IKybaAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Directory_Target__c":25000,"Publication_Visible__c":false,"Id":"a0z1l00000268qiAAA"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qjAAA"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qkAAA"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qlAAA"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qmAAA"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qnAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qoAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qpAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qqAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qrAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qsAAA"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qtAAA"}],"publnName":"International Arbitration 2022","totalpubl":25000},{"publicationId":"a021t00000IKybbAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":350000,"Publication_Visible__c":false,"Id":"a0z1l00000268qKAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":32000,"Publication_Visible__c":false,"Id":"a0z1l00000268qLAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qMAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qNAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qOAAQ"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qPAAQ"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qQAAQ"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qRAAQ"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qSAAQ"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qTAAQ"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qUAAQ"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qVAAQ"}],"publnName":"International Arbitration 2021","totalpubl":382000},{"publicationId":"a021l000002PZKBAA4","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Insights_Target__c":80000,"Publication_Visible__c":false,"Id":"a0z1l00000268qWAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qXAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qYAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qZAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qaAAA"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qbAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qcAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qdAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qeAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qfAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qgAAA"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qhAAA"}],"publnName":"Alternative Energy & Power 2020","totalpubl":80000},{"publicationId":"a021l000002Sw24AAC","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Directory_Target__c":150000,"Insights_Target__c":140000,"Publication_Visible__c":false,"Id":"a0z1l00000268q8AAA"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268q9AAA"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qAAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qBAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qCAAQ"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qDAAQ"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qEAAQ"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qFAAQ"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qGAAQ"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qHAAQ"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qIAAQ"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002Sw24AAC","Publication_Visible__c":false,"Id":"a0z1l00000268qJAAQ"}],"publnName":"TEST","totalpubl":290000}],"totalUser":777000,"userId":"0051t000003QFLVAA4","userName":"Amanda Friend","usTargets":[{"dateTarget":"2020-07-01","directTarget":525000,"insightTarget":220000},{"dateTarget":"2020-08-01","directTarget":32000,"insightTarget":0},{"dateTarget":"2020-09-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-10-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-11-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-12-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-01-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-02-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-03-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-04-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-05-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-06-01","directTarget":0,"insightTarget":0}]}]';
                Integer year = 2020;
        List<Publication__c> listPublic = [SELECT Id, Name FROM Publication__c];
        List<User> listUsers = [SELECT Id FROM User];
        List<String> users = new List<String>();
        for(User u : listUsers){
            users.add(u.Id);
        }
        PersonSalesTargetWithPublController.addPublicationList(listPublic, year, users, jsonOld);
        System.assertEquals(1512, [SELECT Id FROM Sales_Target__c].size());

    }

    @IsTest
    static void deletePublicationTest (){
        String jsonOld = '[{"expanded":false,"publications":[{"publicationId":"a021t00000IKybaAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Directory_Target__c":25000,"Publication_Visible__c":false,"Id":"a0z1l00000268qiAAA"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qjAAA"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qkAAA"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qlAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qoAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qpAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qqAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qrAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qsAAA"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qtAAA"}],"publnName":"International Arbitration 2022","totalpubl":25000},{"publicationId":"a021t00000IKybbAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":350000,"Publication_Visible__c":false,"Id":"a0z1l00000268qKAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":32000,"Publication_Visible__c":false,"Id":"a0z1l00000268qLAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qMAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qNAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qOAAQ"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qPAAQ"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qQAAQ"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qRAAQ"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qSAAQ"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qTAAQ"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qUAAQ"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qVAAQ"}],"publnName":"International Arbitration 2021","totalpubl":382000},{"publicationId":"a021l000002PZKBAA4","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Insights_Target__c":80000,"Publication_Visible__c":false,"Id":"a0z1l00000268qWAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qXAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qYAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qZAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qaAAA"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qbAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qcAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qdAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qeAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qfAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qgAAA"}],"publnName":"TEST","totalpubl":290000}],"totalUser":777000,"userId":"0051t000003QFLVAA4","userName":"Amanda Friend","usTargets":[{"dateTarget":"2020-07-01","directTarget":525000,"insightTarget":220000},{"dateTarget":"2020-08-01","directTarget":32000,"insightTarget":0},{"dateTarget":"2020-09-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-10-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-11-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-12-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-01-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-02-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-03-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-04-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-05-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-06-01","directTarget":0,"insightTarget":0}]}]';
        Integer year = 2020;
        List<Publication__c> listPublic = [SELECT Id, Name FROM Publication__c];
        List<User> listUsers = [SELECT Id FROM User];
        List<String> users = new List<String>();
        for(User u : listUsers){
            users.add(u.Id);
        }
        PersonSalesTargetWithPublController.deletePublication( year, jsonOld);
        System.assertEquals(34, [SELECT Id FROM Sales_Target__c].size());
    }

    @IsTest
    static void saveSalesTargetTest (){
        String jsonOld = '[{"expanded":false,"publications":[{"publicationId":"a021t00000IKybaAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Directory_Target__c":25000,"Publication_Visible__c":false,"Id":"a0z1l00000268qiAAA"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qjAAA"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qkAAA"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qlAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qoAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qpAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qqAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qrAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qsAAA"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybaAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qtAAA"}],"publnName":"International Arbitration 2022","totalpubl":25000},{"publicationId":"a021t00000IKybbAAD","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":350000,"Publication_Visible__c":false,"Id":"a0z1l00000268qKAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Directory_Target__c":32000,"Publication_Visible__c":false,"Id":"a0z1l00000268qLAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qMAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qNAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qOAAQ"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qPAAQ"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qQAAQ"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qRAAQ"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qSAAQ"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qTAAQ"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qUAAQ"},{"Date__c":"2021-06-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021t00000IKybbAAD","Publication_Visible__c":false,"Id":"a0z1l00000268qVAAQ"}],"publnName":"International Arbitration 2021","totalpubl":382000},{"publicationId":"a021l000002PZKBAA4","publicTargets1":[{"Date__c":"2020-07-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Insights_Target__c":80000,"Publication_Visible__c":false,"Id":"a0z1l00000268qWAAQ"},{"Date__c":"2020-08-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qXAAQ"},{"Date__c":"2020-09-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qYAAQ"},{"Date__c":"2020-10-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qZAAQ"},{"Date__c":"2020-11-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qaAAA"},{"Date__c":"2020-12-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qbAAA"},{"Date__c":"2021-01-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qcAAA"},{"Date__c":"2021-02-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qdAAA"},{"Date__c":"2021-03-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qeAAA"},{"Date__c":"2021-04-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qfAAA"},{"Date__c":"2021-05-01","Sales_Person__c":"0051t000003QFLVAA4","Publication__c":"a021l000002PZKBAA4","Publication_Visible__c":false,"Id":"a0z1l00000268qgAAA"}],"publnName":"TEST","totalpubl":290000}],"totalUser":777000,"userId":"0051t000003QFLVAA4","userName":"Amanda Friend","usTargets":[{"dateTarget":"2020-07-01","directTarget":525000,"insightTarget":220000},{"dateTarget":"2020-08-01","directTarget":32000,"insightTarget":0},{"dateTarget":"2020-09-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-10-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-11-01","directTarget":0,"insightTarget":0},{"dateTarget":"2020-12-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-01-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-02-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-03-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-04-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-05-01","directTarget":0,"insightTarget":0},{"dateTarget":"2021-06-01","directTarget":0,"insightTarget":0}]}]';
        Integer year = 2020;
        List<Publication__c> listPublic = [SELECT Id, Name FROM Publication__c];
        List<User> listUsers = [SELECT Id FROM User];
        List<String> users = new List<String>();
        for(User u : listUsers){
            users.add(u.Id);
        }
        PersonSalesTargetWithPublController.saveSalesTarget(year, jsonOld);
        System.assertEquals(34, [SELECT Id FROM Sales_Target__c].size());
    }
}